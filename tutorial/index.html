<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Tutorial | Minotaur</title>
    <meta name="generator" content="VuePress 1.5.0">
    
    <meta name="description" content="A Minimal JavaScript Game Toolkit">
    <link rel="preload" href="/minotaur/assets/css/0.styles.1c163fb1.css" as="style"><link rel="preload" href="/minotaur/assets/js/app.1d080445.js" as="script"><link rel="preload" href="/minotaur/assets/js/2.78f83c87.js" as="script"><link rel="preload" href="/minotaur/assets/js/4.7f068238.js" as="script"><link rel="prefetch" href="/minotaur/assets/js/10.4974f41b.js"><link rel="prefetch" href="/minotaur/assets/js/11.1964c980.js"><link rel="prefetch" href="/minotaur/assets/js/3.21dd16df.js"><link rel="prefetch" href="/minotaur/assets/js/5.0079956b.js"><link rel="prefetch" href="/minotaur/assets/js/6.af7158a9.js"><link rel="prefetch" href="/minotaur/assets/js/7.b9a5b6ab.js"><link rel="prefetch" href="/minotaur/assets/js/8.3d16ad6f.js"><link rel="prefetch" href="/minotaur/assets/js/9.001a046b.js">
    <link rel="stylesheet" href="/minotaur/assets/css/0.styles.1c163fb1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/minotaur/" class="home-link router-link-active"><!----> <span class="site-name">Minotaur</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Guide</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/minotaur/guide/" class="sidebar-link">Getting Started</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/minotaur/guide/SpriteSheet.html" class="sidebar-link">Working with Images</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/minotaur/guide/SpriteSheet.html#drawing-images" class="sidebar-link">Drawing Images</a></li><li class="sidebar-sub-header"><a href="/minotaur/guide/SpriteSheet.html#animated-sprites" class="sidebar-link">Animated Sprites</a></li></ul></li></ul></section></li><li><a href="/minotaur/tutorial/" class="active sidebar-link">Tutorial</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/minotaur/tutorial/#project-setup" class="sidebar-link">Project setup</a></li><li class="sidebar-sub-header"><a href="/minotaur/tutorial/#drawing-shapes" class="sidebar-link">Drawing shapes</a></li><li class="sidebar-sub-header"><a href="/minotaur/tutorial/#animation" class="sidebar-link">Animation</a></li><li class="sidebar-sub-header"><a href="/minotaur/tutorial/#user-input" class="sidebar-link">User input</a></li><li class="sidebar-sub-header"><a href="/minotaur/tutorial/#some-refactoring" class="sidebar-link">Some refactoring</a></li><li class="sidebar-sub-header"><a href="/minotaur/tutorial/#object-collision" class="sidebar-link">Object collision</a></li><li class="sidebar-sub-header"><a href="/minotaur/tutorial/#score-and-game-states" class="sidebar-link">Score and Game states</a></li><li class="sidebar-sub-header"><a href="/minotaur/tutorial/#conclusion" class="sidebar-link">Conclusion</a></li></ul></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Reference</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="tutorial"><a href="#tutorial" class="header-anchor">#</a> Tutorial</h1> <p>In this tutorial, we are going to build a straightforward clone of the game 'PONG' using Minotaur.</p> <p>You can play the final product <a href="https://codyloyd.github.io/minotaur-pong/" target="_blank" rel="noopener noreferrer">HERE<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="a-basic-outline-of-what-we-re-going-to-cover"><a href="#a-basic-outline-of-what-we-re-going-to-cover" class="header-anchor">#</a> A basic outline of what we're going to cover.</h3> <ol><li>Project setup.</li> <li>Drawing shapes with the Canvas API.</li> <li>Animating those shapes.</li> <li>Accepting user input.</li> <li>Object collision.</li> <li>Game states.</li></ol> <h2 id="project-setup"><a href="#project-setup" class="header-anchor">#</a> Project setup</h2> <p>Minotaur was built to be used alongside modern JavaScript build-tools. You can get as far into setting up your environment as you want, but for this tutorial, we're going to keep things pretty basic.</p> <p>We'll be using webpack to build our project and &quot;http-server&quot; to serve it so we can view it in the browser. If you know what you're doing, feel free to use any other combination of bundler and server.</p> <h3 id="installations"><a href="#installations" class="header-anchor">#</a> Installations</h3> <p>Create a folder for the project, and inside it run the following command to install the dependencies we'll need to build our game.</p> <div class="language- extra-class"><pre class="language-text"><code>npm install @codyloyd/minotaur-base

npm install --save-dev webpack webpack-cli

npm install -g simple-http-server
</code></pre></div><p>Run the following commands to create the files we'll be using.</p> <div class="language- extra-class"><pre class="language-text"><code>touch index.html

mkdir src
touch src/index.js
</code></pre></div><p>Add the following basic boilerplate to your <code>index.html</code>:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- index.html --&gt;</span>
<span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>TinyGame!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
    <span class="token selector">body</span> <span class="token punctuation">{</span>
      <span class="token property">background</span><span class="token punctuation">:</span> blue<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">canvas</span> <span class="token punctuation">{</span>
      <span class="token property">border</span><span class="token punctuation">:</span> 4px solid black <span class="token punctuation">;</span>
      <span class="token property">background</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>game<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>dist/main.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Feel free to set up your HTML and CSS however you like. The critical item here is the <code>&lt;div id=&quot;game&quot;&gt;</code> which TinyGame uses to set up the game canvas.</p> <p>In <code>src/index.js</code>, add the following code to import and initialize a new <code>Game</code> object.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// src/index.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Game<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@minotaur/base'</span>

<span class="token keyword">const</span> game <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Game</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  width<span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
  height<span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
  parent<span class="token operator">:</span> <span class="token string">'game'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

game<span class="token punctuation">.</span><span class="token function-variable function">update</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

game<span class="token punctuation">.</span><span class="token function-variable function">draw</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

game<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>At this point, if you build the code with webpack, you should be able to run it in your browser, and see a blank canvas! Run the following in the project folder:</p> <div class="language- extra-class"><pre class="language-text"><code>npx webpack --mode=development --watch
</code></pre></div><p>in another terminal run</p> <div class="language- extra-class"><pre class="language-text"><code>http-server
</code></pre></div><p>Watch the output as the server command runs and look for a URL. The default at the time of this writing is <code>http://localhost:8080</code>, but depending on the specifics of your system, it might be slightly different. Whatever the URL is, open it in your browser. You should see this:</p> <p><img src="/minotaur/assets/img/blank.f5df2f5b.png" alt="blank canvas"></p> <h2 id="drawing-shapes"><a href="#drawing-shapes" class="header-anchor">#</a> Drawing shapes</h2> <p>To draw shapes to our canvas, we are going to reference the native HTML Canvas API.</p> <ul><li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Basic_usage" target="_blank" rel="noopener noreferrer">Here is an introduction<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to Canvas if you've never seen it</li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D" target="_blank" rel="noopener noreferrer">This page<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> is probably the most useful documentation page.</li></ul> <p>You don't need to know everything about Canvas to get started here. The general overview provided by the links above should be good enough for now.</p> <p>Instead of re-implementing all of these canvas drawing functions, Minotaur exposes the rendering context of the game canvas that <code>new Game()</code> creates. Therefore, to draw shapes, all you need to do is reference that context and use the built-in methods!</p> <p>In your <code>src/index.js</code> file, add a <code>fillRect</code> function to your game.draw() function like this:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>game<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>When you refresh your browser, you should now see a 100px wide black square in the upper corner of your Canvas!</p> <p>Most Canvas drawing functions, and therefore most Minotaur functions, take a similar set of arguments. In this case, the arguments are, in order:</p> <ol><li><code>x</code>: the x coordinates of the top-left corner of our shape</li> <li><code>y</code>: the y coordinates of the top-left corner of our shape</li> <li><code>width</code>: the width of our shape</li> <li><code>height</code>: the height of our shape</li></ol> <p>Which means, we've drawn a rectangle that starts at <code>x:20, y:20</code> and is <code>100px/100px</code>.</p> <h3 id="game-objects"><a href="#game-objects" class="header-anchor">#</a> Game Objects</h3> <p>For our PONG clone, we're going to need three shapes:</p> <ul><li>Two rectangle paddles</li> <li>a ball.</li></ul> <p>To keep our code organized and to make moving these shapes around easier later, we're going to store them in JavaScript objects.</p> <p>Add these objects to your <code>src/index.js</code> and then draw them inside your <code>game.draw()</code> function:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> ball <span class="token operator">=</span> <span class="token punctuation">{</span>
  x<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
  y<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
  radius<span class="token operator">:</span> <span class="token number">15</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> leftPaddle <span class="token operator">=</span> <span class="token punctuation">{</span>
  x<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  y<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  w<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  h<span class="token operator">:</span> <span class="token number">100</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> rightPaddle <span class="token operator">=</span> <span class="token punctuation">{</span>
  x<span class="token operator">:</span> game<span class="token punctuation">.</span>width <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">,</span>
  y<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  w<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  h<span class="token operator">:</span> <span class="token number">100</span>
<span class="token punctuation">}</span>

game<span class="token punctuation">.</span><span class="token function-variable function">draw</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span>leftPaddle<span class="token punctuation">.</span>x<span class="token punctuation">,</span> leftPaddle<span class="token punctuation">.</span>y<span class="token punctuation">,</span> leftPaddle<span class="token punctuation">.</span>w<span class="token punctuation">,</span> leftPaddle<span class="token punctuation">.</span>h<span class="token punctuation">)</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span>rightPaddle<span class="token punctuation">.</span>x<span class="token punctuation">,</span> rightPaddle<span class="token punctuation">.</span>y<span class="token punctuation">,</span> rightPaddle<span class="token punctuation">.</span>w<span class="token punctuation">,</span> rightPaddle<span class="token punctuation">.</span>h<span class="token punctuation">)</span>

  <span class="token comment">// this is the code for drawing a circle for our ball.</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span>ball<span class="token punctuation">.</span>x<span class="token punctuation">,</span> ball<span class="token punctuation">.</span>y<span class="token punctuation">,</span> ball<span class="token punctuation">.</span>radius<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The code for drawing a circle is a little tedious, so if it's something that you're going to be doing a lot you may want to abstract it out to it's own function like so:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">drawCircle</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>radius</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span>ball<span class="token punctuation">.</span>x<span class="token punctuation">,</span> ball<span class="token punctuation">.</span>y<span class="token punctuation">,</span> ball<span class="token punctuation">.</span>radius<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Since we only need to draw one ball, we don't need to worry about this for now.</p> <h3 id="color"><a href="#color" class="header-anchor">#</a> Color</h3> <p>Drawing in color with Canvas is easy. Before doing a drawing operation, set a <code>fillStyle</code> using a css-color string. For something as simple as PONG, we don't need much color, but just to keep things interesting, let's pick a couple of colors for our paddles and ball. You can use any color that would be recognized in a css file such as an <code>rgb</code> or <code>hsl</code> color. Even <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/color_value#Color_keywords" target="_blank" rel="noopener noreferrer">named colors<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> are recognized.</p> <p>Let's use a couple of hex colors for now.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>game<span class="token punctuation">.</span><span class="token function-variable function">draw</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// this fillRect covers the entire screen and is the 'background' for our game</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&quot;#003049&quot;</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>game<span class="token punctuation">.</span>width<span class="token punctuation">,</span> game<span class="token punctuation">.</span>height<span class="token punctuation">)</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&quot;#eae2b7&quot;</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span>leftPaddle<span class="token punctuation">.</span>x<span class="token punctuation">,</span> leftPaddle<span class="token punctuation">.</span>y<span class="token punctuation">,</span> leftPaddle<span class="token punctuation">.</span>w<span class="token punctuation">,</span> leftPaddle<span class="token punctuation">.</span>h<span class="token punctuation">)</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span>rightPaddle<span class="token punctuation">.</span>x<span class="token punctuation">,</span> rightPaddle<span class="token punctuation">.</span>y<span class="token punctuation">,</span> rightPaddle<span class="token punctuation">.</span>w<span class="token punctuation">,</span> rightPaddle<span class="token punctuation">.</span>h<span class="token punctuation">)</span>

  <span class="token comment">// this is the code for drawing a circle for our ball.</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&quot;#fcbf49&quot;</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span>ball<span class="token punctuation">.</span>x<span class="token punctuation">,</span> ball<span class="token punctuation">.</span>y<span class="token punctuation">,</span> ball<span class="token punctuation">.</span>radius<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>At this point, your code should <a href="https://gist.github.com/codyloyd/0dae073b76753afe578cbd618c875fd7" target="_blank" rel="noopener noreferrer">look like <em>this</em><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>And running the game gives us this:
<img src="/minotaur/assets/img/colors.eff5df9b.png" alt="color"></p> <h2 id="animation"><a href="#animation" class="header-anchor">#</a> Animation</h2> <p>To set things into motion, update each game object's position variables inside of the <code>game.update()</code> function.</p> <p>To begin with, moving the ball across the screen is as simple as doing something like this:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>game<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token parameter">dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  ball<span class="token punctuation">.</span>x <span class="token operator">+=</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The above code runs every frame and increments the <code>x</code> position of the ball by 1px. However, the following issues arise:</p> <ul><li>The movement speed is dependent on the game's framerate.</li> <li>The speed of the ball is constant and cannot be changed.</li></ul> <p>Updating our ball object and the <code>game.update()</code> function fixes both of these issues.</p> <p>First, add variables to your ball object for x and y velocity. Call them <code>vx</code> and <code>vy</code> and then use those variables to control the speed of the ball:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> ball <span class="token operator">=</span> <span class="token punctuation">{</span>
  x<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
  y<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
  vx<span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
  vy<span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span>
  radius<span class="token operator">:</span> <span class="token number">15</span>
<span class="token punctuation">}</span>

game<span class="token punctuation">.</span><span class="token function-variable function">update</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// update ball position</span>
  ball<span class="token punctuation">.</span>x <span class="token operator">+=</span> ball<span class="token punctuation">.</span>vx <span class="token operator">*</span> dt
  ball<span class="token punctuation">.</span>y <span class="token operator">+=</span> ball<span class="token punctuation">.</span>vy <span class="token operator">*</span> dt
<span class="token punctuation">}</span>
</code></pre></div><p>Notice that in the above snippet, we multiply the velocity by <code>game.update</code>'s <code>dt</code> parameter. This parameter stands for the amount of time that has elapsed since the last time <code>game.update</code> has been called. Doing this calculation keeps the speed of the ball consistent, even if the framerate lags and the time between each iteration of the update function are inconsistent.</p> <h3 id="wall-bounce"><a href="#wall-bounce" class="header-anchor">#</a> Wall Bounce</h3> <p>Making the ball bounce off of the walls requires checking the position of the ball and changing its direction once it hits the edge of the game canvas. We can do this check inside of the update function like so:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>game<span class="token punctuation">.</span><span class="token function-variable function">update</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// update ball position</span>
  ball<span class="token punctuation">.</span>x <span class="token operator">+=</span> ball<span class="token punctuation">.</span>vx <span class="token operator">*</span> dt
  ball<span class="token punctuation">.</span>y <span class="token operator">+=</span> ball<span class="token punctuation">.</span>vy <span class="token operator">*</span> dt
  
  <span class="token keyword">if</span> <span class="token punctuation">(</span>ball<span class="token punctuation">.</span>x <span class="token operator">&gt;</span> game<span class="token punctuation">.</span>width <span class="token operator">-</span> ball<span class="token punctuation">.</span>radius <span class="token operator">||</span> ball<span class="token punctuation">.</span>x <span class="token operator">&lt;</span> ball<span class="token punctuation">.</span>radius<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ball<span class="token punctuation">.</span>vx <span class="token operator">*=</span> <span class="token operator">-</span><span class="token number">1</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>ball<span class="token punctuation">.</span>y <span class="token operator">&gt;</span> game<span class="token punctuation">.</span>width <span class="token operator">-</span> ball<span class="token punctuation">.</span>radius <span class="token operator">||</span> ball<span class="token punctuation">.</span>y <span class="token operator">&lt;</span> ball<span class="token punctuation">.</span>radius<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ball<span class="token punctuation">.</span>vy <span class="token operator">*=</span> <span class="token operator">-</span><span class="token number">1</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>With circles, the <code>x</code> and <code>y</code> coordinates refer to the center of the circle, and the <code>radius</code> is the distance from the center to the edge. Therefore when we do the calculation we have to take ball.radius into account.</p> <p>On our game canvas, the ball is considered out of bounds if <code>ball.x</code> is bigger than <code>game.width - ball.radius</code> or if it is smaller than <code>ball.radius</code>.</p> <p>If you run the game now, the ball should move and bounce around the screen. Feel free to update the velocity variables inside the ball object to fine-tune the speed.</p> <h2 id="user-input"><a href="#user-input" class="header-anchor">#</a> User input</h2> <p>Minotaur does not need to handle input for you, because JavaScript and the native DOM API are already perfectly capable of that. Handling user input is as easy as setting up event listeners.</p> <p>In your <code>index.js</code> file, add a function to handle keypresses and then add a 'keydown' event listener that uses it.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">handleKeydown</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> key <span class="token operator">=</span> event<span class="token punctuation">.</span>key
  <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token string">'ArrowUp'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// move paddle up</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token string">'ArrowDown'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// move paddle down</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'keydown'</span><span class="token punctuation">,</span> handleKeydown<span class="token punctuation">)</span>
</code></pre></div><p>Inside this function, we simply need to update our paddle position using the objects we've already set up. For now, we're going to keep the two paddles in sync, but you might want to either add a different set of keys for a second player or implement a little AI so you can play against the computer.</p> <p>Our updated <code>handleKeydown</code> function:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">handleKeydown</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> key <span class="token operator">=</span> event<span class="token punctuation">.</span>key
  <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token string">'ArrowUp'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    leftPaddle<span class="token punctuation">.</span>y <span class="token operator">-=</span> <span class="token number">10</span>
    rightPaddle<span class="token punctuation">.</span>y <span class="token operator">-=</span> <span class="token number">10</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token string">'ArrowDown'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    leftPaddle<span class="token punctuation">.</span>y <span class="token operator">+=</span> <span class="token number">10</span>
    rightPaddle<span class="token punctuation">.</span>y <span class="token operator">+=</span> <span class="token number">10</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The above code is functional but introduces two easily fixed problems.</p> <ul><li>The paddles do not move smoothly when you press and hold a key down and depending on your computer's key-repeat settings, you might have to smash the arrow keys repeatedly to get the paddle to move more than 10px at a time.</li> <li>The paddles can move off the screen!</li></ul> <p>There are a few steps required to fix the first issue:</p> <ol><li>Add a property for the paddle's velocity (<code>vy</code>) to each paddle. (We don't need a <code>vx</code> because the paddles can only move up and down.)</li> <li>Use that property to update the position of the paddle.</li> <li>Change the paddle's velocity when a key is pressed and reset the velocity when that key is released.</li></ol> <h3 id="smooth-paddle-motion"><a href="#smooth-paddle-motion" class="header-anchor">#</a> Smooth Paddle Motion</h3> <h4 id="add-velocity-property-to-paddles"><a href="#add-velocity-property-to-paddles" class="header-anchor">#</a> Add velocity property to paddles:</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> leftPaddle <span class="token operator">=</span> <span class="token punctuation">{</span>
  x<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  y<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  w<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  h<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  <span class="token comment">// ADD THIS!</span>
  vy<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> rightPaddle <span class="token operator">=</span> <span class="token punctuation">{</span>
  x<span class="token operator">:</span> game<span class="token punctuation">.</span>width <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">,</span>
  y<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  w<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  h<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  <span class="token comment">// ADD THIS!</span>
  vy<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="update-position-of-paddles-in-game-update"><a href="#update-position-of-paddles-in-game-update" class="header-anchor">#</a> Update position of paddles in game.update</h4> <div class="language-js extra-class"><pre class="language-js"><code>game<span class="token punctuation">.</span><span class="token function-variable function">update</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// update ball position</span>
  ball<span class="token punctuation">.</span>x <span class="token operator">+=</span> ball<span class="token punctuation">.</span>vx <span class="token operator">*</span> dt
  ball<span class="token punctuation">.</span>y <span class="token operator">+=</span> ball<span class="token punctuation">.</span>vy <span class="token operator">*</span> dt

  <span class="token comment">//ADD THIS!</span>
  <span class="token comment">// update paddle position</span>
  leftPaddle<span class="token punctuation">.</span>y <span class="token operator">+=</span> leftPaddle<span class="token punctuation">.</span>vy <span class="token operator">*</span> dt
  rightPaddle<span class="token punctuation">.</span>y <span class="token operator">+=</span> rightPaddle<span class="token punctuation">.</span>vy <span class="token operator">*</span> dt

  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="use-keypresses-to-change-paddle-velocity"><a href="#use-keypresses-to-change-paddle-velocity" class="header-anchor">#</a> Use keypresses to change paddle velocity.</h4> <p>Since we want to change the velocity only when a key is pressed down, we need to do a little refactoring to our handleKeydown function and add a new function for handling keyUp. There are many possible ways to solve this problem. We're going to add an object for keeping track of which keys are pressed down at any given time and then manipulate that object in our keypress-handlers.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> isDown <span class="token operator">=</span> <span class="token punctuation">{</span>
  ArrowUp<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  ArrowDown<span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">handleKeydown</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> key <span class="token operator">=</span> event<span class="token punctuation">.</span>key
  <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token string">'ArrowUp'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    isDown<span class="token punctuation">.</span>ArrowUp <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token string">'ArrowDown'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    isDown<span class="token punctuation">.</span>ArrowDown <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">handleKeyup</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> key <span class="token operator">=</span> event<span class="token punctuation">.</span>key
  <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token string">'ArrowUp'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    isDown<span class="token punctuation">.</span>ArrowUp <span class="token operator">=</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token string">'ArrowDown'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    isDown<span class="token punctuation">.</span>ArrowDown <span class="token operator">=</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'keydown'</span><span class="token punctuation">,</span> handleKeydown<span class="token punctuation">)</span>
document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'keyup'</span><span class="token punctuation">,</span> handleKeyup<span class="token punctuation">)</span>
</code></pre></div><p>Then, we can use the <code>isDown</code> object to update our paddle velocity inside the <code>game.update</code> function. To make sure the velocity is always reset to <code>0</code> when keys are released, we're going to <em>always</em> set it to <code>0</code>, and then check for <code>isDown</code> on our keys to override that.</p> <div class="language-js extra-class"><pre class="language-js"><code>game<span class="token punctuation">.</span><span class="token function-variable function">update</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// update ball position</span>
  ball<span class="token punctuation">.</span>x <span class="token operator">+=</span> ball<span class="token punctuation">.</span>vx <span class="token operator">*</span> dt
  ball<span class="token punctuation">.</span>y <span class="token operator">+=</span> ball<span class="token punctuation">.</span>vy <span class="token operator">*</span> dt

  <span class="token comment">// update paddle velocity</span>
  leftPaddle<span class="token punctuation">.</span>vy <span class="token operator">=</span> <span class="token number">0</span>
  rightPaddle<span class="token punctuation">.</span>vy <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isDown<span class="token punctuation">.</span>ArrowDown<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    leftPaddle<span class="token punctuation">.</span>vy <span class="token operator">=</span> <span class="token number">180</span>
    rightPaddle<span class="token punctuation">.</span>vy <span class="token operator">=</span> <span class="token number">180</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isDown<span class="token punctuation">.</span>ArrowUp<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    leftPaddle<span class="token punctuation">.</span>vy <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">180</span>
    rightPaddle<span class="token punctuation">.</span>vy <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">180</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// update paddle position</span>
  leftPaddle<span class="token punctuation">.</span>y <span class="token operator">+=</span> leftPaddle<span class="token punctuation">.</span>vy <span class="token operator">*</span> dt
  rightPaddle<span class="token punctuation">.</span>y <span class="token operator">+=</span> rightPaddle<span class="token punctuation">.</span>vy <span class="token operator">*</span> dt
</code></pre></div><h3 id="keep-the-paddles-on-the-screen"><a href="#keep-the-paddles-on-the-screen" class="header-anchor">#</a> Keep the paddles on the screen</h3> <p>Keeping the paddles from going off the edge of the screen can be handled in basically the same way as our ball collision. We're just going to set the velocity of the paddles to <code>0</code> when they hit the border. We're also going to reset the paddle's position to the actual limit so that the paddle doesn't get 'stuck' in the wall.
This adds quite a bit of code, so here is the entire <code>game.update</code> function</p> <div class="language-js extra-class"><pre class="language-js"><code>game<span class="token punctuation">.</span><span class="token function-variable function">update</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// update ball position</span>
  ball<span class="token punctuation">.</span>x <span class="token operator">+=</span> ball<span class="token punctuation">.</span>vx <span class="token operator">*</span> dt
  ball<span class="token punctuation">.</span>y <span class="token operator">+=</span> ball<span class="token punctuation">.</span>vy <span class="token operator">*</span> dt

  <span class="token keyword">if</span> <span class="token punctuation">(</span>ball<span class="token punctuation">.</span>x <span class="token operator">&gt;</span> game<span class="token punctuation">.</span>width <span class="token operator">-</span> ball<span class="token punctuation">.</span>radius <span class="token operator">||</span> ball<span class="token punctuation">.</span>x <span class="token operator">&lt;</span> ball<span class="token punctuation">.</span>radius<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ball<span class="token punctuation">.</span>vx <span class="token operator">*=</span> <span class="token operator">-</span><span class="token number">1</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>ball<span class="token punctuation">.</span>y <span class="token operator">&gt;</span> game<span class="token punctuation">.</span>width <span class="token operator">-</span> ball<span class="token punctuation">.</span>radius <span class="token operator">||</span> ball<span class="token punctuation">.</span>y <span class="token operator">&lt;</span> ball<span class="token punctuation">.</span>radius<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ball<span class="token punctuation">.</span>vy <span class="token operator">*=</span> <span class="token operator">-</span><span class="token number">1</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// update paddle velocity</span>
  leftPaddle<span class="token punctuation">.</span>vy <span class="token operator">=</span> <span class="token number">0</span>
  rightPaddle<span class="token punctuation">.</span>vy <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isDown<span class="token punctuation">.</span>ArrowDown<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    leftPaddle<span class="token punctuation">.</span>vy <span class="token operator">=</span> <span class="token number">180</span>
    rightPaddle<span class="token punctuation">.</span>vy <span class="token operator">=</span> <span class="token number">180</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isDown<span class="token punctuation">.</span>ArrowUp<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    leftPaddle<span class="token punctuation">.</span>vy <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">180</span>
    rightPaddle<span class="token punctuation">.</span>vy <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">180</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>leftPaddle<span class="token punctuation">.</span>y <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    leftPaddle<span class="token punctuation">.</span>vy <span class="token operator">=</span> <span class="token number">0</span>
    leftPaddle<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>leftPaddle<span class="token punctuation">.</span>y <span class="token operator">&gt;</span> game<span class="token punctuation">.</span>height <span class="token operator">-</span> leftPaddle<span class="token punctuation">.</span>h<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    leftPaddle<span class="token punctuation">.</span>vy <span class="token operator">=</span> <span class="token number">0</span>
    leftPaddle<span class="token punctuation">.</span>y <span class="token operator">=</span> game<span class="token punctuation">.</span>height <span class="token operator">-</span> leftPaddle<span class="token punctuation">.</span>h 
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>rightPaddle<span class="token punctuation">.</span>y <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    rightPaddle<span class="token punctuation">.</span>vy <span class="token operator">=</span> <span class="token number">0</span>
    rightPaddle<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>rightPaddle<span class="token punctuation">.</span>y <span class="token operator">&gt;</span> game<span class="token punctuation">.</span>height <span class="token operator">-</span> rightPaddle<span class="token punctuation">.</span>h<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    rightPaddle<span class="token punctuation">.</span>vy <span class="token operator">=</span> <span class="token number">0</span>
    rightPaddle<span class="token punctuation">.</span>y <span class="token operator">=</span> game<span class="token punctuation">.</span>height <span class="token operator">-</span> rightPaddle<span class="token punctuation">.</span>h 
  <span class="token punctuation">}</span>

  <span class="token comment">// update paddle position</span>
  leftPaddle<span class="token punctuation">.</span>y <span class="token operator">+=</span> leftPaddle<span class="token punctuation">.</span>vy <span class="token operator">*</span> dt
  rightPaddle<span class="token punctuation">.</span>y <span class="token operator">+=</span> rightPaddle<span class="token punctuation">.</span>vy <span class="token operator">*</span> dt
<span class="token punctuation">}</span>
</code></pre></div><h2 id="some-refactoring"><a href="#some-refactoring" class="header-anchor">#</a> Some refactoring</h2> <p>You may have noticed that our last few updates have added quite a bit of repeated code since we have to do the same position and velocity checks for each paddle every time. Almost any other game is going to end up being much more complicated than this one, so it's a problem that's worth solving. To clean it up, we're going to abstract out our paddle code into a simple class and put all of the update code into <em>that</em> file. Doing so will clean up our update function considerably.</p> <p>Since we're using webpack we can move the paddle logic to a new file easily. Add a new file to your project directory called <code>paddle.js</code> and then import it at the top of your <code>index.js</code> like so:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/index.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Paddle<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./paddle'</span>
</code></pre></div><p>Create a new <code>Paddle</code> class inside the new file and export it. This snippet is empty but has all the functions we're going to implement.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/paddle.js</span>
<span class="token keyword">class</span> <span class="token class-name">Paddle</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> w<span class="token punctuation">,</span> h</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span>
  <span class="token function">update</span><span class="token punctuation">(</span><span class="token parameter">dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span>
  <span class="token function">draw</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span>Paddle<span class="token punctuation">}</span>
</code></pre></div><h4 id="the-constructor-function"><a href="#the-constructor-function" class="header-anchor">#</a> The constructor function.</h4> <p>If we fill out our constructor function, we can begin using the class to create our objects immeditately.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/paddle.js</span>
<span class="token keyword">class</span> <span class="token class-name">Paddle</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> w<span class="token punctuation">,</span> h</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x
    <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> y
    <span class="token keyword">this</span><span class="token punctuation">.</span>w <span class="token operator">=</span> w
    <span class="token keyword">this</span><span class="token punctuation">.</span>h <span class="token operator">=</span> h
    <span class="token keyword">this</span><span class="token punctuation">.</span>vy <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token punctuation">}</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/index.js</span>
<span class="token comment">// remove the original leftPaddle and rightPaddle objects, </span>
<span class="token comment">// replace them with this:</span>
<span class="token keyword">const</span> leftPaddle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Paddle</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> rightPaddle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Paddle</span><span class="token punctuation">(</span>game<span class="token punctuation">.</span>width<span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">100</span>
</code></pre></div><p>At this point, the game should still run as it did before, next lets move the update logic into our class. There are some global variables being accessed inside our game's update function, so to get them into the <code>Paddle.update</code> we are going to pass them in as arguments. The following code is essentially our original <code>leftPaddle</code> update code with <code>leftPaddle</code> renamed to <code>this</code>.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/paddle.js</span>
<span class="token keyword">class</span> <span class="token class-name">Paddle</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token function">update</span><span class="token punctuation">(</span><span class="token parameter">dt<span class="token punctuation">,</span> isDown<span class="token punctuation">,</span> height</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>vy <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isDown<span class="token punctuation">.</span>ArrowDown<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>vy <span class="token operator">=</span> <span class="token number">180</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isDown<span class="token punctuation">.</span>ArrowUp<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>vy <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">180</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>vy <span class="token operator">=</span> <span class="token number">0</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">&gt;</span> height <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>h<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>vy <span class="token operator">=</span> <span class="token number">0</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> height <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>h 
    <span class="token punctuation">}</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">+=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>vy <span class="token operator">*</span> dt
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>We can now, remove all of the update code from our index update loop and replace it like so:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/index.js</span>
game<span class="token punctuation">.</span><span class="token function-variable function">update</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// update ball position</span>
  ball<span class="token punctuation">.</span>x <span class="token operator">+=</span> ball<span class="token punctuation">.</span>vx <span class="token operator">*</span> dt
  ball<span class="token punctuation">.</span>y <span class="token operator">+=</span> ball<span class="token punctuation">.</span>vy <span class="token operator">*</span> dt

  <span class="token keyword">if</span> <span class="token punctuation">(</span>ball<span class="token punctuation">.</span>x <span class="token operator">&gt;</span> game<span class="token punctuation">.</span>width <span class="token operator">-</span> ball<span class="token punctuation">.</span>radius <span class="token operator">||</span> ball<span class="token punctuation">.</span>x <span class="token operator">&lt;</span> ball<span class="token punctuation">.</span>radius<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ball<span class="token punctuation">.</span>vx <span class="token operator">*=</span> <span class="token operator">-</span><span class="token number">1</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>ball<span class="token punctuation">.</span>y <span class="token operator">&gt;</span> game<span class="token punctuation">.</span>width <span class="token operator">-</span> ball<span class="token punctuation">.</span>radius <span class="token operator">||</span> ball<span class="token punctuation">.</span>y <span class="token operator">&lt;</span> ball<span class="token punctuation">.</span>radius<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ball<span class="token punctuation">.</span>vy <span class="token operator">*=</span> <span class="token operator">-</span><span class="token number">1</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// update paddles</span>
  leftPaddle<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>dt<span class="token punctuation">,</span> isDown<span class="token punctuation">,</span> game<span class="token punctuation">.</span>height<span class="token punctuation">)</span>
  rightPaddle<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>dt<span class="token punctuation">,</span> isDown<span class="token punctuation">,</span> game<span class="token punctuation">.</span>height<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Finally, follow the same process with the 'draw' logic. Notice we're passing in the <code>game.context</code> so our paddles know where to draw themselves.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/paddle.js</span>
<span class="token keyword">class</span> <span class="token class-name">Paddle</span> <span class="token punctuation">{</span>
  <span class="token function">draw</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    context<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&quot;#eae2b7&quot;</span>
    context<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>w<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>h<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/index.js</span>
game<span class="token punctuation">.</span><span class="token function-variable function">draw</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// this fillRect covers the entire screen and is the 'background' for our game</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&quot;#003049&quot;</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>game<span class="token punctuation">.</span>width<span class="token punctuation">,</span> game<span class="token punctuation">.</span>height<span class="token punctuation">)</span>

  <span class="token comment">// draw paddles</span>
  leftPaddle<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span>game<span class="token punctuation">.</span>context<span class="token punctuation">)</span>
  rightPaddle<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span>game<span class="token punctuation">.</span>context<span class="token punctuation">)</span>

  <span class="token comment">// this is the code for drawing a circle for our ball.</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&quot;#fcbf49&quot;</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span>ball<span class="token punctuation">.</span>x<span class="token punctuation">,</span> ball<span class="token punctuation">.</span>y<span class="token punctuation">,</span> ball<span class="token punctuation">.</span>radius<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The complete current status of <code>index.js</code> and <code>paddle.js</code> can be found <a href="https://gist.github.com/codyloyd/f439bb80e6b9f1c3031f8535f8c934c3" target="_blank" rel="noopener noreferrer">in this gist<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>If you want, you could easily replicate this refactoring step with the ball, in a new file called <code>ball.js</code>. For now, since we only have one ball, we won't worry about doing that.</p> <h2 id="object-collision"><a href="#object-collision" class="header-anchor">#</a> Object collision</h2> <p>Lets get our ball bouncing off of those paddles! The algorithm for checking whether or not the ball is colliding with the paddles is below. Add it to your index.js. For more information about this very useful algorithm search &quot;AABB collision detection&quot;.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">isBallColliding</span><span class="token punctuation">(</span><span class="token parameter">paddle</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>ball<span class="token punctuation">.</span>x <span class="token operator">-</span> ball<span class="token punctuation">.</span>radius <span class="token operator">&lt;</span> paddle<span class="token punctuation">.</span>x <span class="token operator">+</span> paddle<span class="token punctuation">.</span>w <span class="token operator">&amp;&amp;</span>
    ball<span class="token punctuation">.</span>x <span class="token operator">+</span> ball<span class="token punctuation">.</span>radius <span class="token operator">&gt;</span> paddle<span class="token punctuation">.</span>x <span class="token operator">&amp;&amp;</span>
    ball<span class="token punctuation">.</span>y <span class="token operator">-</span> ball<span class="token punctuation">.</span>radius <span class="token operator">&lt;</span> paddle<span class="token punctuation">.</span>y <span class="token operator">+</span> paddle<span class="token punctuation">.</span>h <span class="token operator">&amp;&amp;</span>
    ball<span class="token punctuation">.</span>y <span class="token operator">+</span> ball<span class="token punctuation">.</span>radius <span class="token operator">&gt;</span> paddle<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>All we have to do now is use the <code>isBallColliding</code> function in our game.update like so:</p> <div class="language-js extra-class"><pre class="language-js"><code>game<span class="token punctuation">.</span><span class="token function-variable function">update</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isBallColliding</span><span class="token punctuation">(</span>leftPaddle<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">isBallColliding</span><span class="token punctuation">(</span>rightPaddle<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ball<span class="token punctuation">.</span>vx <span class="token operator">*=</span> <span class="token operator">-</span><span class="token number">1</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Now,  your ball should bounce off the paddles!</p> <h2 id="score-and-game-states"><a href="#score-and-game-states" class="header-anchor">#</a> Score and Game states</h2> <p>The game is pretty much complete now! All we need to do is add a running score, and create starting and ending screens.</p> <h3 id="score"><a href="#score" class="header-anchor">#</a> Score</h3> <p>As usual, there are multiple viable ways of managing each of these things. We <em>could</em> add the <code>score</code> variable to our Paddle class, or we could create a new <code>Player</code> class to manage things like that.  To keep things simple, we're just going to store a <code>score</code> object in our index.js.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/index.js</span>
<span class="token keyword">const</span> score <span class="token operator">=</span> <span class="token punctuation">{</span>
  player1<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  player2<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Draw the score to the screen in the <code>game.draw</code> function. There's a little math involved in getting it lined up to the center of the screen.</p> <div class="language-js extra-class"><pre class="language-js"><code>game<span class="token punctuation">.</span><span class="token function-variable function">draw</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token keyword">const</span> scoreText <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>score<span class="token punctuation">.</span>player1<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> | </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>score<span class="token punctuation">.</span>player2<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
  <span class="token keyword">const</span> textWidth <span class="token operator">=</span> game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">measureText</span><span class="token punctuation">(</span>scoreText<span class="token punctuation">)</span><span class="token punctuation">.</span>width
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&quot;#eae2b7&quot;</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">&quot;48px&quot;</span>
  game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span>scoreText<span class="token punctuation">,</span><span class="token punctuation">(</span>game<span class="token punctuation">.</span>width<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">(</span>textWidth<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span>game<span class="token punctuation">.</span>width<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Now, in the <code>game.update</code> add the logic to increment the correct player's score when the ball hits one of the sides. We'll also reset the ball position to the middle of the screen and change it's direction when it hits. Currently, we're still doing the 'wall bounce' off of those walls, but now that we have working paddles, we can remove that and replace it with our scoring code. Here is the entire game.update function.</p> <div class="language-js extra-class"><pre class="language-js"><code>game<span class="token punctuation">.</span><span class="token function-variable function">update</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// update ball position</span>
  ball<span class="token punctuation">.</span>x <span class="token operator">+=</span> ball<span class="token punctuation">.</span>vx <span class="token operator">*</span> dt
  ball<span class="token punctuation">.</span>y <span class="token operator">+=</span> ball<span class="token punctuation">.</span>vy <span class="token operator">*</span> dt

  <span class="token keyword">if</span> <span class="token punctuation">(</span>ball<span class="token punctuation">.</span>y <span class="token operator">&gt;</span> game<span class="token punctuation">.</span>width <span class="token operator">-</span> ball<span class="token punctuation">.</span>radius <span class="token operator">||</span> ball<span class="token punctuation">.</span>y <span class="token operator">&lt;</span> ball<span class="token punctuation">.</span>radius<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ball<span class="token punctuation">.</span>vy <span class="token operator">*=</span> <span class="token operator">-</span><span class="token number">1</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// this is what we're adding!</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>ball<span class="token punctuation">.</span>x <span class="token operator">&gt;</span> game<span class="token punctuation">.</span>width <span class="token operator">-</span> ball<span class="token punctuation">.</span>radius<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// increment score</span>
    score<span class="token punctuation">.</span>player2 <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token comment">// reset position</span>
    ball<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">200</span>
    ball<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">200</span>
    <span class="token comment">// change it's direction</span>
    ball<span class="token punctuation">.</span>vx <span class="token operator">*=</span> <span class="token operator">-</span><span class="token number">1</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>ball<span class="token punctuation">.</span>x <span class="token operator">&lt;</span> ball<span class="token punctuation">.</span>radius<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// increment score</span>
    score<span class="token punctuation">.</span>player1 <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token comment">// reset position</span>
    ball<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">200</span>
    ball<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">200</span>
    <span class="token comment">// change it's direction</span>
    ball<span class="token punctuation">.</span>vx <span class="token operator">*=</span> <span class="token operator">-</span><span class="token number">1</span>
  <span class="token punctuation">}</span>

  leftPaddle<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>dt<span class="token punctuation">,</span> isDown<span class="token punctuation">,</span> game<span class="token punctuation">.</span>height<span class="token punctuation">)</span>
  rightPaddle<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>dt<span class="token punctuation">,</span> isDown<span class="token punctuation">,</span> game<span class="token punctuation">.</span>height<span class="token punctuation">)</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isBallColliding</span><span class="token punctuation">(</span>leftPaddle<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">isBallColliding</span><span class="token punctuation">(</span>rightPaddle<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ball<span class="token punctuation">.</span>vx <span class="token operator">*=</span> <span class="token operator">-</span><span class="token number">1</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="game-states"><a href="#game-states" class="header-anchor">#</a> Game states</h3> <p>Game state logic can get quite complicated, but for a game as simple as this one, it doesn't need to be too involved. We're going to:</p> <ol><li>Create a variable called <code>gameState</code>.</li> <li>Use that variable to determine what we draw on the screen.</li> <li>Update that variable in our code when appropriate to change the game state.</li></ol> <p>Add the following to index.js:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> gameState <span class="token operator">=</span> <span class="token string">'start'</span>
</code></pre></div><p>In a more complicated game, we <em>could</em> end up with many different states. For now, we're going to stick to 'start', 'play' and 'end'.</p> <p>The Draw function for each of these screens can get quite long. In some cases, it might make more sense to move these screen draw functions into new modules. For the sake of clarity, we'll keep them in index.js. All we need to do is check the <code>gameState</code> variable inside of our draw function, draw our 'title' screen if the state is <code>play</code>, draw the 'game over' screen if it is <code>end</code> and draw the actual game screen if it is <code>play</code>.</p> <p>Add the following to the top of your game.draw function.</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">if</span> <span class="token punctuation">(</span>gameState <span class="token operator">===</span> <span class="token string">'start'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    game<span class="token punctuation">.</span>context<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&quot;#001029&quot;</span>
    game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>game<span class="token punctuation">.</span>width<span class="token punctuation">,</span> game<span class="token punctuation">.</span>height<span class="token punctuation">)</span>
    game<span class="token punctuation">.</span>context<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&quot;#eae2b7&quot;</span>
    game<span class="token punctuation">.</span>context<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">&quot;48px serif&quot;</span>
    <span class="token keyword">let</span> textWidth <span class="token operator">=</span> game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">measureText</span><span class="token punctuation">(</span><span class="token string">'PONG'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width
    game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span><span class="token string">&quot;PONG&quot;</span><span class="token punctuation">,</span> game<span class="token punctuation">.</span>width<span class="token operator">/</span><span class="token number">2</span> <span class="token operator">-</span> textWidth<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>

    game<span class="token punctuation">.</span>context<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">&quot;28px serif&quot;</span>
    <span class="token keyword">const</span> subtitle <span class="token operator">=</span> <span class="token string">'press any key'</span>
    textWidth <span class="token operator">=</span> game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">measureText</span><span class="token punctuation">(</span>subtitle<span class="token punctuation">)</span><span class="token punctuation">.</span>width
    game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span>subtitle<span class="token punctuation">,</span> game<span class="token punctuation">.</span>width<span class="token operator">/</span><span class="token number">2</span> <span class="token operator">-</span> textWidth<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span>

    <span class="token comment">// return is significant here. We don't want to draw anything else</span>
    <span class="token comment">// if we're in the 'start' state</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>gameState <span class="token operator">===</span> <span class="token string">'end'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    game<span class="token punctuation">.</span>context<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&quot;#001029&quot;</span>
    game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>game<span class="token punctuation">.</span>width<span class="token punctuation">,</span> game<span class="token punctuation">.</span>height<span class="token punctuation">)</span>
    game<span class="token punctuation">.</span>context<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&quot;#eae2b7&quot;</span>
    game<span class="token punctuation">.</span>context<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">&quot;48px serif&quot;</span>
    <span class="token keyword">let</span> textWidth <span class="token operator">=</span> game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">measureText</span><span class="token punctuation">(</span><span class="token string">'GAME OVER'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width
    game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span><span class="token string">&quot;GAME OVER&quot;</span><span class="token punctuation">,</span> game<span class="token punctuation">.</span>width<span class="token operator">/</span><span class="token number">2</span> <span class="token operator">-</span> textWidth<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>

    game<span class="token punctuation">.</span>context<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">&quot;28px serif&quot;</span>
    <span class="token keyword">const</span> subtitle <span class="token operator">=</span> <span class="token string">'press any key'</span>
    textWidth <span class="token operator">=</span> game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">measureText</span><span class="token punctuation">(</span>subtitle<span class="token punctuation">)</span><span class="token punctuation">.</span>width
    game<span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span>subtitle<span class="token punctuation">,</span> game<span class="token punctuation">.</span>width<span class="token operator">/</span><span class="token number">2</span> <span class="token operator">-</span> textWidth<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span>

    <span class="token comment">// return is significant here. We don't want to draw anything else</span>
    <span class="token comment">// if we're in the 'end' state</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>Notice we're doing that <code>measureText</code> calculation multiple times to center our text. It might be a good idea to move that out to a new function.</p> <p>We also need to add a statement to the top of our update function to make sure the game isn't running in the background while we're not on the <code>play</code> screen.</p> <div class="language-js extra-class"><pre class="language-js"><code>game<span class="token punctuation">.</span><span class="token function-variable function">update</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>gameState <span class="token operator">===</span> <span class="token string">&quot;start&quot;</span> <span class="token operator">||</span> gameState <span class="token operator">===</span> <span class="token string">&quot;end&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Add the following code to the <code>handleKeydown</code> function, so that our &quot;start&quot; and &quot;end&quot; states transition when pressing any key:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">handleKeydown</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> key <span class="token operator">=</span> event<span class="token punctuation">.</span>key
  <span class="token comment">// ADD THIS</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>gameState <span class="token operator">===</span> <span class="token string">&quot;start&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// reset the score for a new game!</span>
    score<span class="token punctuation">.</span>player1 <span class="token operator">=</span> <span class="token number">0</span>
    score<span class="token punctuation">.</span>player2 <span class="token operator">=</span> <span class="token number">0</span>
    gameState <span class="token operator">=</span> <span class="token string">&quot;play&quot;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// AND THIS</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>gameState <span class="token operator">===</span> <span class="token string">&quot;end&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    gameState <span class="token operator">=</span> <span class="token string">&quot;start&quot;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token string">'ArrowUp'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    isDown<span class="token punctuation">.</span>ArrowUp <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token string">'ArrowDown'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    isDown<span class="token punctuation">.</span>ArrowDown <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><em>Finally</em>, add a check inside of <code>game.update</code> to end the game when one player gets 5 points</p> <div class="language-js extra-class"><pre class="language-js"><code>game<span class="token punctuation">.</span>update <span class="token operator">=</span> <span class="token function">funtion</span><span class="token punctuation">(</span><span class="token parameter">dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>score<span class="token punctuation">.</span>player1 <span class="token operator">==</span> <span class="token number">5</span> <span class="token operator">||</span> score<span class="token punctuation">.</span>player2 <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    gameState <span class="token operator">=</span> <span class="token string">&quot;end&quot;</span>
  <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre></div><h2 id="conclusion"><a href="#conclusion" class="header-anchor">#</a> Conclusion</h2> <p>That's it!  The game is in a state that we could call 'complete'.  Of course, NO game is ever <em>actually</em> finished, is it?</p> <p>The code for our completed project can be found in <a href="https://github.com/codyloyd/minotaur-pong" target="_blank" rel="noopener noreferrer">this repo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>You can play that example <a href="https://codyloyd.github.io/minotaur-pong/" target="_blank" rel="noopener noreferrer">HERE<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h3 id="what-next"><a href="#what-next" class="header-anchor">#</a> What next?</h3> <p>There are several improvements you could make to this game. Consider the following:</p> <ul><li>Display the winner on the 'end' screen.</li> <li>Make it work for two players or one player vs. computer.</li> <li>Make the ball speed up as the game progresses.</li> <li>Add 'powerups' like extra balls, or an extra-long paddle.</li> <li>Add a 'paused' state.</li> <li>Use pretty images instead of basic shapes.</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/minotaur/guide/SpriteSheet.html" class="prev">
        Working with Images
      </a></span> <span class="next"><a href="/minotaur/api-reference/">
        API Reference
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/minotaur/assets/js/app.1d080445.js" defer></script><script src="/minotaur/assets/js/2.78f83c87.js" defer></script><script src="/minotaur/assets/js/4.7f068238.js" defer></script>
  </body>
</html>
